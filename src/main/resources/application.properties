spring.application.name=pcpartsscraper

# Database Configuration
spring.datasource.url=jdbc:postgresql://localhost:5432/pcpartsdb
spring.datasource.username=pcparts_user
spring.datasource.password=pcparts_password
spring.datasource.driver-class-name=org.postgresql.Driver

# Connection Pool Configuration - Optimized for concurrent scraping with leak prevention
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.maximum-pool-size=30
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.pool-name=PCPartsScraperPool
spring.datasource.hikari.leak-detection-threshold=600000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.initialization-fail-timeout=1
spring.datasource.hikari.isolate-internal-queries=false
spring.datasource.hikari.allow-pool-suspension=false
spring.datasource.hikari.read-only=false
spring.datasource.hikari.register-mbeans=false

# JPA/Hibernate Configuration - Optimized for performance
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.hbm2ddl.halt_on_error=false
spring.jpa.properties.hibernate.hbm2ddl.auto=update
spring.jpa.properties.hibernate.schema_update.unique_constraint_strategy=skip

# Quartz Configuration - Simplified for Spring Boot auto-configuration
spring.quartz.job-store-type=jdbc
spring.quartz.jdbc.initialize-schema=always
spring.quartz.auto-startup=true
spring.quartz.startup-delay=10s
spring.quartz.wait-for-jobs-to-complete-on-shutdown=true
spring.quartz.overwrite-existing-jobs=true

# Core Quartz Properties - Simplified
spring.quartz.properties.org.quartz.scheduler.instanceName=PCPartsScraperScheduler
spring.quartz.properties.org.quartz.scheduler.instanceId=AUTO
spring.quartz.properties.org.quartz.scheduler.skipUpdateCheck=true

# JobStore Configuration - Simplified for Spring Boot
spring.quartz.properties.org.quartz.jobStore.class=org.springframework.scheduling.quartz.LocalDataSourceJobStore
spring.quartz.properties.org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.PostgreSQLDelegate
spring.quartz.properties.org.quartz.jobStore.useProperties=true
spring.quartz.properties.org.quartz.jobStore.misfireThreshold=60000
spring.quartz.properties.org.quartz.jobStore.tablePrefix=QRTZ_
spring.quartz.properties.org.quartz.jobStore.isClustered=false

# Thread Pool Configuration
spring.quartz.properties.org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool
spring.quartz.properties.org.quartz.threadPool.threadCount=3
spring.quartz.properties.org.quartz.threadPool.threadPriority=5

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,scheduledtasks,quartz
management.endpoint.health.show-details=when-authorized

# Logging Configuration
logging.level.com.tadeasfort.pcpartsscraper=DEBUG
logging.level.org.quartz=INFO
logging.level.com.zaxxer.hikari=DEBUG
logging.level.com.zaxxer.hikari.pool.HikariPool=DEBUG
logging.level.com.zaxxer.hikari.pool.ProxyLeakTask=INFO

# Application Specific
app.scraping.enabled=true
app.scraping.bazos.interval-hours=3
app.scraping.bazos.stagger-start=true
app.scraping.bazos.max-concurrent-categories=5
app.scraping.bazos.duplicate-stop-threshold=0.8

# Bazos Scraping Performance Configuration - Optimized for faster scraping
# These delays significantly reduce scraping time while remaining respectful to the server
# OLD values: listing=200ms, page=1500ms, category=3000ms (would take ~2+ hours)
# NEW values: listing=50ms, page=300ms, category=500ms (should take ~30-40 minutes)
app.scraping.bazos.listing-delay-ms=50
app.scraping.bazos.page-delay-ms=300
app.scraping.bazos.category-delay-ms=500
app.scraping.bazos.connect-timeout-ms=5000
app.scraping.bazos.use-tor=false

# Tor Proxy Configuration - Disabled by default for better performance during bulk scraping
app.tor.enabled=false
app.tor.host=127.0.0.1
app.tor.socks-port=9050
app.tor.control-port=9051
app.tor.rotation-interval=10

# TechPowerUp Scraping Configuration
app.scraping.techpowerup.base-delay-ms=2000
app.scraping.techpowerup.max-delay-ms=8000
app.scraping.techpowerup.max-retries=3
app.scraping.techpowerup.timeout-ms=15000
app.scraping.techpowerup.use-tor=true

# Disable Docker Compose integration
spring.docker.compose.enabled=false
